import{x as C,A as g,T as M,B as A,C as U,D,o as a,F as o,af as _,O as t,al as q,am as y,an as T,J as j,P as z,ag as r}from"./index-89021e36.js";import{c as N,a as f,b as P,u as $,d as u,V as E}from"./vee-validate.esm-6c01c182.js";import{F as R}from"./FooterSection-492eb289.js";import{V as J}from"./VContainer-54c5c76a.js";import{V as O,a as l}from"./VRow-1c82926f.js";import{V as G}from"./VTextarea-90fc25fe.js";import"./_commonjsHelpers-39b5b250.js";const H={class:"h-100 bg-grey-lighten-2"},I=r("h1",{class:"text-center"},"出售商品",-1),K=r("h3",null,"販售方法",-1),L=r("p",{class:"text-caption"},"由商家自行決定",-1),Q=r("h3",{class:"mb-3"},"商品名稱",-1),W=r("h3",{class:"mb-3"},"商品縮圖",-1),X=r("h3",{class:"mb-3"},"商品說明",-1),Y=r("h3",{class:"mb-3"},"商品分類",-1),Z=r("h3",{class:"mb-3"},"商品價格",-1),ie={__name:"SellerView",setup(ee){const v=C(),x=["漫畫","插畫","素材","音樂","3D模型","遊戲","公仔"],w=N({name:f().required("缺少商品名稱"),price:P().typeError("價格錯誤").required("缺少價格").min(0,"價格錯誤"),description:f().required("缺少商品說明"),category:f().required("缺少商品分類").test("isCategory",n=>["漫畫","插畫","素材","音樂","3D模型","遊戲","公仔"].includes(n))}),{handleSubmit:F,isSubmitting:V,resetForm:S}=$({validationSchema:w}),d=u("name"),c=u("price"),m=u("description"),p=u("category"),i=g([]),b=g([]),h=g(null),k=F(async n=>{if(i.value.length!==0)try{const e=new FormData;e.append("name",n.name),e.append("price",n.price),e.append("description",n.description),e.append("category",n.category),e.append("image",i.value[0].file),S(),h.value.deleteFileRecord(),await M.post("/products",e),v({text:"新增成功",showCloseButton:!1,snackbarProps:{timeout:3e3,color:"success",location:"bottom"}})}catch(e){v({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"error",location:"bottom"}})}});return(n,e)=>{const B=A("VueFileAgent");return U(),D("div",H,[a(J,null,{default:o(()=>[a(O,{class:"justify-center align-center mb-15"},{default:o(()=>[a(l,{cols:"12"},{default:o(()=>[I,a(_)]),_:1}),a(l,{class:"h-100 bg-white",cols:"6"},{default:o(()=>[a(E,{disabled:t(V),onSubmit:q(t(k),["prevent"])},{default:o(()=>[a(l,{cols:"12"},{default:o(()=>[K,L]),_:1}),a(_),a(l,{cols:"12"},{default:o(()=>[Q,a(y,{modelValue:t(d).value.value,"onUpdate:modelValue":e[0]||(e[0]=s=>t(d).value.value=s),"error-messages":t(d).errorMessage.value,variant:"outlined",density:"compact",clearable:"",placeholder:"請輸入商品名稱"},null,8,["modelValue","error-messages"])]),_:1}),a(l,{cols:"12"},{default:o(()=>[W,a(B,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),"raw-model-value":b.value,"onUpdate:rawModelValue":e[2]||(e[2]=s=>b.value=s),ref_key:"fileAgent",ref:h,compact:!0,"thumbnail-size":1200,"max-files":1,"max-size":"1MB",multiple:!1,deletable:"",accept:"image/jpg, image/jpeg, image/png","help-text":"請選擇檔案或拖放到這裡","error-text":{type:"檔案格式錯誤",size:"檔案太大"}},null,8,["modelValue","raw-model-value"])]),_:1}),a(l,{cols:"12"},{default:o(()=>[X,a(G,{modelValue:t(m).value.value,"onUpdate:modelValue":e[3]||(e[3]=s=>t(m).value.value=s),"error-messages":t(m).errorMessage.value,variant:"outlined",density:"compact",placeholder:"請輸入商品說明"},null,8,["modelValue","error-messages"])]),_:1}),a(l,{cols:"3"},{default:o(()=>[Y,a(T,{items:x,modelValue:t(p).value.value,"onUpdate:modelValue":e[4]||(e[4]=s=>t(p).value.value=s),"error-messages":t(p).errorMessage.value,variant:"outlined",density:"compact",clearable:"",hint:"請選擇商品分類"},null,8,["modelValue","error-messages"])]),_:1}),a(l,{cols:"6"},{default:o(()=>[Z,a(y,{modelValue:t(c).value.value,"onUpdate:modelValue":e[5]||(e[5]=s=>t(c).value.value=s),modelModifiers:{number:!0},"error-messages":t(c).errorMessage.value,variant:"outlined",density:"compact",type:"number",placeholder:"請輸入商品價格","append-inner-icon":"mdi-cash"},null,8,["modelValue","error-messages"])]),_:1}),a(l,{cols:"12"},{default:o(()=>[a(j,{class:"font-weight-black",color:"light-blue",variant:"tonal",type:"submit",loading:t(V)},{default:o(()=>[z("出售")]),_:1},8,["loading"])]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}),a(R,{style:{height:"150px"}})])}}};export{ie as default};
