import{p as H,aR as W,g as N,a9 as E,aS as X,aT as Y,l as M,o as e,q as I,aU as J,aV as Z,a4 as Q,aW as ee,I as O,aX as te,z as G,aY as ae,aZ as F,H as A,a_ as le,a$ as oe,x as se,b0 as re,A as B,r as ne,T as $,B as j,C as m,D as g,F as t,b1 as ue,P as y,N as ce,aE as C,aF as de,ag as n,am as ie,b2 as pe,E as D,J as V,G as w,K as me,U as x,V as fe,af as L}from"./index-5019ac1a.js";import{V as ve}from"./VContainer-7042b4a0.js";import{V as T,a as h}from"./VRow-9737687b.js";const ye=H({disabled:Boolean,modelValue:{type:Boolean,default:void 0},...W()},"VHover"),Ve=N()({name:"VHover",props:ye(),emits:{"update:modelValue":a=>!0},setup(a,d){let{slots:i}=d;const l=E(a,"modelValue"),{runOpenDelay:v,runCloseDelay:c}=X(a,r=>!a.disabled&&(l.value=r));return()=>{var r;return(r=i.default)==null?void 0:r.call(i,{isHovering:l.value,props:{onMouseenter:v,onMouseleave:c}})}}}),be=H({...Y({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),z=N()({name:"VRadio",props:be(),setup(a,d){let{slots:i}=d;return M(()=>e(J,I(a,{class:["v-radio",a.class],style:a.style,type:"radio"}),i)),{}}});const _e=H({height:{type:[Number,String],default:"auto"},...Z(),...Q(ee(),["multiple"]),trueIcon:{type:O,default:"$radioOn"},falseIcon:{type:O,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),ge=N()({name:"VRadioGroup",inheritAttrs:!1,props:_e(),emits:{"update:modelValue":a=>!0},setup(a,d){let{attrs:i,slots:l}=d;const v=te(),c=G(()=>a.id||`radio-group-${v}`),r=E(a,"modelValue");return M(()=>{const[b,P]=ae(i),[R,U]=F.filterProps(a),[S,q]=J.filterProps(a),o=l.label?l.label({label:a.label,props:{for:c.value}}):a.label;return e(F,I({class:["v-radio-group",a.class],style:a.style},b,R,{modelValue:r.value,"onUpdate:modelValue":u=>r.value=u,id:c.value}),{...l,default:u=>{let{id:p,messagesId:f,isDisabled:s,isReadonly:k}=u;return e(A,null,[o&&e(le,{id:p.value},{default:()=>[o]}),e(oe,I(S,{id:p.value,"aria-describedby":f.value,defaultsTarget:"VRadio",trueIcon:a.trueIcon,falseIcon:a.falseIcon,type:a.type,disabled:s.value,readonly:k.value,"aria-labelledby":o?p.value:void 0,multiple:!1},P,{modelValue:r.value,"onUpdate:modelValue":_=>r.value=_}),l)])}})}),{}}}),xe={class:"bg-grey-lighten-3 h-100"},he=n("h1",{class:"text-center text-blue-grey-darken-2 mb-5"},"商品結帳",-1),ke={class:"bg-grey-lighten-3 mb-5"},Ce=n("p",{class:"mb-3 text-h6 text-center"},"請輸入地址",-1),we={class:"d-flex w-100 justify-space-between"},Be={__name:"CartView",setup(a){const d=se(),i=re(),l=B([]),v=ne(),c=B(1),r=B(""),b=async(o,u)=>{try{const{data:p}=await $.post("/users/cart",{product:o,quantity:u}),f=l.value.findIndex(s=>s.product._id===o);l.value[f].quantity+=u,l.value[f].quantity<=0&&l.value.splice(f,1),v.cart=p.result}catch(p){d({text:p.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"error",location:"bottom"}})}},P=G(()=>l.value.reduce((o,u)=>o+u.quantity*u.product.price,0)),R=G(()=>l.value.length>0&&!l.value.some(o=>!o.product.sell)),U=async()=>{try{const o={address:r.value};await $.post("/orders",o),v.cart=0,i.push("/")}catch(o){d({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"error",location:"bottom"}})}},S=()=>{c.value+=1},q=()=>{c.value-=1};return(async()=>{try{const{data:o}=await $.get("/users/cart");l.value.push(...o.result)}catch(o){d({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"error",location:"bottom"}})}})(),(o,u)=>{const p=j("RouterLink"),f=j("VStepper");return m(),g("div",xe,[e(ve,null,{default:t(()=>[e(T,null,{default:t(()=>[e(h,{cols:"12"},{default:t(()=>[he,e(f,{items:["清單資料","輸入地址","送出訂單"],"model-value":c.value,"hide-actions":""},ue({"item.2":t(()=>[e(C,null,{default:t(()=>[e(de,{class:"text-center text-h4 font-weight-bold"},{default:t(()=>[y("填寫地址資訊")]),_:1}),e(T,{class:"pa-15","no-gutters":""},{default:t(()=>[e(h,{cols:"12"},{default:t(()=>[n("div",ke,[e(ge,{class:"d-flex justify-center align-center radio-label",inline:"",label:"送貨方式"},{default:t(()=>[e(z,{label:"自宅配送",value:"1"}),e(z,{label:"超商自取",value:"2"})]),_:1})])]),_:1}),e(h,{cols:"12"},{default:t(()=>[Ce,e(ie,{class:"ms-auto me-auto",modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=s=>r.value=s),type:"text",placeholder:"請輸入地址","prepend-inner-icon":"mdi-map-marker",variant:"outlined",clearable:"",density:"compact",style:{width:"50%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),"item.3":t(()=>[e(C,{title:"Step Three",flat:""},{default:t(()=>[y("...")]),_:1})]),_:2},[l.value.length===0?{name:"item.1",fn:t(()=>[y("沒有商品")]),key:"0"}:{name:"item.1",fn:t(()=>[(m(!0),g(A,null,ce(l.value,(s,k)=>(m(),g(A,{key:s._id},[e(C,{class:"rounded-0 mb-2 elevation-0 d-flex"},{default:t(()=>[e(T,{class:"w-100"},{default:t(()=>[e(h,{cols:"2"},{default:t(()=>[e(me,{src:s.product.image,cover:"","min-width":"120",width:"150","aspect-ratio":"1"},null,8,["src"])]),_:2},1024),e(h,{cols:"10"},{default:t(()=>[n("div",{class:"d-flex align-center"},[e(p,{class:"text-decoration-none",to:"/products/"+s.product._id},{default:t(()=>[n("p",{class:"text-grey-darken-3 text-h5 font-weight-bold"},x(s.product.name),1)]),_:2},1032,["to"]),e(Ve,null,{default:t(({isHovering:_,props:K})=>[e(V,I({class:"ms-auto"},K,{color:_?"red":"grey-lighten-2",variant:"text",icon:"mdi-close-thick",onClick:Ie=>b(s.product._id,s.quantity*-1),size:"32"}),null,16,["color","onClick"])]),_:2},1024)]),n("div",{class:"my-2 d-flex align-center"},[e(fe,{class:"me-2",icon:"mdi-tag",color:"pink",size:"14"}),n("span",{class:"text-subtitle-1 text-pink"},x(s.product.price)+" NTD",1)]),n("div",{class:"my-5 pa-5 bg-grey-lighten-4 w-100"},[n("pre",{class:"w-50 text-desc text-caption"},x(s.product.description),1)]),e(L,{class:"my-5"}),n("div",{class:"d-flex align-center justify-end"},[e(V,{color:"primary",variant:"text",icon:"mdi-minus",onClick:_=>b(s.product._id,-1)},null,8,["onClick"]),n("span",{class:"text-subtitle-2"},x(s.quantity),1),e(V,{color:"primary",variant:"text",icon:"mdi-plus",onClick:_=>b(s.product._id,1)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(L,{class:"ma-5"}),n("div",{class:"d-flex justify-end align-center"},[k===l.value.length-1?(m(),g("span",{key:0},"總金額：")):w("",!0),k===l.value.length-1?(m(),g("p",{key:1,class:"text-pink text-h4 font-weight-bold"},"$"+x(P.value),1)):w("",!0)])],64))),128))]),key:"1"}]),1032,["model-value"]),e(C,{class:"my-1"},{default:t(()=>[e(pe,null,{default:t(()=>[n("div",we,[c.value===2?(m(),D(V,{key:0,class:"mx-2",color:"blue",onClick:q,variant:"tonal"},{default:t(()=>[y("上一步")]),_:1})):w("",!0),c.value===1?(m(),D(V,{key:1,class:"mx-2",color:"blue",onClick:S},{default:t(()=>[y("下一步")]),_:1})):c.value!==3?(m(),D(V,{key:2,class:"mx-2",color:"blue",onClick:U,disabled:!R.value},{default:t(()=>[y("送出訂單")]),_:1},8,["disabled"])):w("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}};export{Be as default};
