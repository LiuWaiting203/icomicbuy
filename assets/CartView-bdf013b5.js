import{p as q,aN as Q,g as A,a9 as M,aO as W,aP as X,l as E,o as e,q as P,aQ as J,aR as Y,a4 as Z,aS as ee,I as U,aT as ae,z as G,aU as te,aV as j,H as N,aW as le,aX as oe,x as se,aY as re,A as B,r as ne,T as D,B as F,C as m,D as g,F as a,aZ as ue,P as y,N as ce,ah as C,ae as de,ak as n,aq as ie,a_ as pe,E as $,J as V,G as w,K as me,U as h,V as fe,aj as L}from"./index-2c369155.js";import{V as ve}from"./VContainer-129d0fb9.js";import{V as T,a as x}from"./VRow-1ef26a63.js";const ye=q({disabled:Boolean,modelValue:{type:Boolean,default:void 0},...Q()},"VHover"),Ve=A()({name:"VHover",props:ye(),emits:{"update:modelValue":t=>!0},setup(t,d){let{slots:i}=d;const l=M(t,"modelValue"),{runOpenDelay:v,runCloseDelay:c}=W(t,r=>!t.disabled&&(l.value=r));return()=>{var r;return(r=i.default)==null?void 0:r.call(i,{isHovering:l.value,props:{onMouseenter:v,onMouseleave:c}})}}}),_e=q({...X({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),z=A()({name:"VRadio",props:_e(),setup(t,d){let{slots:i}=d;return E(()=>e(J,P(t,{class:["v-radio",t.class],style:t.style,type:"radio"}),i)),{}}});const be=q({height:{type:[Number,String],default:"auto"},...Y(),...Z(ee(),["multiple"]),trueIcon:{type:U,default:"$radioOn"},falseIcon:{type:U,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),ge=A()({name:"VRadioGroup",inheritAttrs:!1,props:be(),emits:{"update:modelValue":t=>!0},setup(t,d){let{attrs:i,slots:l}=d;const v=ae(),c=G(()=>t.id||`radio-group-${v}`),r=M(t,"modelValue");return E(()=>{const[_,I]=te(i),[R,H]=j.filterProps(t),[S,O]=J.filterProps(t),o=l.label?l.label({label:t.label,props:{for:c.value}}):t.label;return e(j,P({class:["v-radio-group",t.class],style:t.style},_,R,{modelValue:r.value,"onUpdate:modelValue":u=>r.value=u,id:c.value}),{...l,default:u=>{let{id:p,messagesId:f,isDisabled:s,isReadonly:k}=u;return e(N,null,[o&&e(le,{id:p.value},{default:()=>[o]}),e(oe,P(S,{id:p.value,"aria-describedby":f.value,defaultsTarget:"VRadio",trueIcon:t.trueIcon,falseIcon:t.falseIcon,type:t.type,disabled:s.value,readonly:k.value,"aria-labelledby":o?p.value:void 0,multiple:!1},I,{modelValue:r.value,"onUpdate:modelValue":b=>r.value=b}),l)])}})}),{}}}),he={class:"bg-grey-lighten-3 h-100"},xe=n("h1",{class:"text-center mb-5"},"商品結帳",-1),ke={class:"bg-grey-lighten-3 mb-5"},Ce=n("p",{class:"mb-3 text-h6 text-center"},"請輸入地址",-1),we={class:"d-flex w-100 justify-space-between"},Be={__name:"CartView",setup(t){const d=se(),i=re(),l=B([]),v=ne(),c=B(1),r=B(""),_=async(o,u)=>{try{const{data:p}=await D.post("/users/cart",{product:o,quantity:u}),f=l.value.findIndex(s=>s.product._id===o);l.value[f].quantity+=u,l.value[f].quantity<=0&&l.value.splice(f,1),v.cart=p.result}catch(p){d({text:p.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"error",location:"bottom"}})}},I=G(()=>l.value.reduce((o,u)=>o+u.quantity*u.product.price,0)),R=G(()=>l.value.length>0&&!l.value.some(o=>!o.product.sell)),H=async()=>{try{const o={address:r.value};await D.post("/orders",o),v.cart=0,i.push("/")}catch(o){d({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"error",location:"bottom"}})}},S=()=>{c.value+=1},O=()=>{c.value-=1};return(async()=>{try{const{data:o}=await D.get("/users/cart");l.value.push(...o.result)}catch(o){d({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:3e3,color:"error",location:"bottom"}})}})(),(o,u)=>{const p=F("RouterLink"),f=F("VStepper");return m(),g("div",he,[e(ve,null,{default:a(()=>[e(T,null,{default:a(()=>[e(x,{cols:"12"},{default:a(()=>[xe,e(f,{items:["清單資料","輸入地址","送出訂單"],"model-value":c.value,"hide-actions":""},ue({"item.2":a(()=>[e(C,null,{default:a(()=>[e(de,{class:"text-center text-h4 font-weight-bold"},{default:a(()=>[y("填寫地址資訊")]),_:1}),e(T,{class:"pa-15","no-gutters":""},{default:a(()=>[e(x,{cols:"12"},{default:a(()=>[n("div",ke,[e(ge,{class:"d-flex justify-center align-center radio-label",inline:"",label:"送貨方式"},{default:a(()=>[e(z,{label:"自宅配送",value:"1"}),e(z,{label:"超商自取",value:"2"})]),_:1})])]),_:1}),e(x,{cols:"12"},{default:a(()=>[Ce,e(ie,{class:"ms-auto me-auto",modelValue:r.value,"onUpdate:modelValue":u[0]||(u[0]=s=>r.value=s),type:"text",placeholder:"請輸入地址","prepend-inner-icon":"mdi-map-marker",variant:"outlined",clearable:"",density:"compact",style:{width:"50%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),"item.3":a(()=>[e(C,{title:"Step Three",flat:""},{default:a(()=>[y("...")]),_:1})]),_:2},[l.value.length===0?{name:"item.1",fn:a(()=>[y("沒有商品")]),key:"0"}:{name:"item.1",fn:a(()=>[(m(!0),g(N,null,ce(l.value,(s,k)=>(m(),g(N,{key:s._id},[e(C,{class:"rounded-0 mb-2 elevation-0 d-flex"},{default:a(()=>[e(T,{class:"w-100"},{default:a(()=>[e(x,{cols:"2"},{default:a(()=>[e(me,{src:s.product.image,cover:"","min-width":"120",width:"150","aspect-ratio":"1"},null,8,["src"])]),_:2},1024),e(x,{cols:"10"},{default:a(()=>[n("div",{class:"d-flex align-center"},[e(p,{class:"text-decoration-none",to:"/products/"+s.product._id},{default:a(()=>[n("p",{class:"text-grey-darken-3 text-h5 font-weight-bold"},h(s.product.name),1)]),_:2},1032,["to"]),e(Ve,null,{default:a(({isHovering:b,props:K})=>[e(V,P({class:"ms-auto"},K,{color:b?"red":"grey-lighten-2",variant:"text",icon:"mdi-close-thick",onClick:Pe=>_(s.product._id,s.quantity*-1),size:"32"}),null,16,["color","onClick"])]),_:2},1024)]),n("div",{class:"my-2 d-flex align-center"},[e(fe,{class:"me-2",icon:"mdi-tag",color:"pink",size:"14"}),n("span",{class:"text-subtitle-1 text-pink"},h(s.product.price)+" NTD",1)]),n("div",{class:"my-5 pa-5 bg-grey-lighten-4 w-100"},[n("pre",{class:"w-50 text-desc text-caption"},h(s.product.description),1)]),e(L,{class:"my-5"}),n("div",{class:"d-flex align-center justify-end"},[e(V,{color:"primary",variant:"text",icon:"mdi-minus",onClick:b=>_(s.product._id,-1)},null,8,["onClick"]),n("span",{class:"text-subtitle-2"},h(s.quantity),1),e(V,{color:"primary",variant:"text",icon:"mdi-plus",onClick:b=>_(s.product._id,1)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(L,{class:"ma-5"}),n("div",{class:"d-flex justify-end align-center"},[k===l.value.length-1?(m(),g("span",{key:0},"總金額：")):w("",!0),k===l.value.length-1?(m(),g("p",{key:1,class:"text-pink text-h4 font-weight-bold"},"$"+h(I.value),1)):w("",!0)])],64))),128))]),key:"1"}]),1032,["model-value"]),e(C,{class:"my-1"},{default:a(()=>[e(pe,null,{default:a(()=>[n("div",we,[c.value===2?(m(),$(V,{key:0,class:"mx-2",color:"blue",onClick:O,variant:"tonal"},{default:a(()=>[y("上一步")]),_:1})):w("",!0),c.value===1?(m(),$(V,{key:1,class:"mx-2",color:"blue",onClick:S},{default:a(()=>[y("下一步")]),_:1})):c.value!==3?(m(),$(V,{key:2,class:"mx-2",color:"blue",onClick:H,disabled:!R.value},{default:a(()=>[y("送出訂單")]),_:1},8,["disabled"])):w("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}};export{Be as default};
